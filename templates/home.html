<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>INDIGGator</title>
    <script src="https://cdn.ethers.io/lib/ethers-5.2.umd.min.js" type="application/javascript"></script>
</head>
<body>
        <button onClick="connectWallet();" id="connect-wallet"> MetaMask login</button>
        
                <div >
                    <form method="post" action="{% url 'home' %}" >
                        {% csrf_token %}
    
                        <input type="text" name="WalletAddress" value="Please Connect with wallet" id="WalletAddress" readonly required>
                        <input type="text" name="name" id="username" placeholder="Enter name"  required/>
                        <input type="text" name="referalCode" id="referalCode" placeholder="referalCode optional" />
                        <button type="submit" id="btn-submit">Getting started</button>
                    </form>
                </div>
    
        <script>
        async function connectWallet() {

            if (window.ethereum) {
                console.log(window.ethereum);
                const provider_t = new ethers.providers.Web3Provider(window.ethereum);
                const signer_t = provider_t.getSigner();
                const allWalletAccounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
                console.log(allWalletAccounts);
                document.getElementById('WalletAddress').value = allWalletAccounts[0];

                document.getElementById('connect-wallet').hidden = true;
            }
        }

        </script>
</body>
</html>